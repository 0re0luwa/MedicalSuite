@page
@using System.Security.Claims
@model MedicalSuiteWeb.Pages.Prescriptions.ViewPrescriptionsModel
@{
    ViewData["Title"] = "View Prescriptions";
}
@{
    if (HttpContext.User.FindFirstValue(ClaimTypes.Role) != null)
    {
        Layout = LayoutAuthorizer.GetLayoutFromRole(this.HttpContext);
    }
    else
    {
        Layout = "_Layout";
    }
}

<form method="post" class="form-group">
    <div class="row m-2">
        <div class="col-1">
            <a class="btn btn-primary" asp-area="" asp-page="/Prescriptions/AddPrescription">Add</a>
        </div>
    </div>
    <div class="row m-3">
        <div class="col-2">
            <label class="form-label">Person</label>
        </div>
        <div class="col-7">
            <select asp-for="SelectedPersonId" asp-items="Model.People"></select>
        </div>
        <div class="col-1">
            <button class="btn btn-primary" id="btnView">Display</button>
        </div>
    </div>

    @if (Model.Prescriptions.Count == 0)
    {
        <p>No prescriptions found for the selected person.</p>
    }
    else
    {
        @foreach (var prescription in Model.Prescriptions)
        {
            <div class="row m-2 border">
                <div class="row m-2">
                    <div class="col-2">
                        <label class="form-label">Prescription Name:</label>
                    </div>
                    <div class="col-10">
                        <label class="form-label">@prescription.PrescriptionName</label>
                    </div>
                </div>

                <div class="row m-2">
                    <div class="col-2">
                        <label class="form-label">Prescription Strength:</label>
                    </div>
                    <div class="col-10">
                        <label class="form-label">@prescription.PrescriptionStrength</label>
                    </div>
                </div>

                <div class="row m-2">
                    <div class="col-2">
                        <label class="form-label">Prescription Quantity:</label>
                    </div>
                    <div class="col-10">
                        <label class="form-label">@prescription.PrescriptionQuantity</label>
                    </div>
                </div>

                <div class="row m-2">
                    <div class="col-2">
                        <label class="form-label">Prescription Directions:</label>
                    </div>
                    <div class="col-10">
                        <label class="form-label">@prescription.PrescriptionDirections</label>
                    </div>
                </div>

                <div class="row m-2">
                    <div class="col-2">
                        <label class="form-label">Written Date:</label>
                    </div>
                    <div class="col-10">
                        <label class="form-label">@prescription.WrittenDate.ToString("yyyy-MM-dd")</label>
                    </div>
                </div>

                <div class="row m-2">
                    <div class="col-2">
                        <label class="form-label">Expiration Date:</label>
                    </div>
                    <div class="col-10">
                        <label class="form-label">@prescription.ExpirationDate.ToString("yyyy-MM-dd")</label>
                    </div>
                </div>

                <div class="row m-2">
                    <div class="col-2">
                        <label class="form-label">Notes:</label>
                    </div>
                    <div class="col-10">
                        <label class="form-label">@prescription.Notes</label>
                    </div>
                </div>

                <div class="row m-2">
                    <div class="col-2">
                        <a asp-page="EditPrescription" asp-route-id="@prescription.PrescriptionId" class="btn btn-primary">Edit</a>
                    </div>
                    <div class="col-2">
                        <a asp-page="DeletePrescription" asp-route-id="@prescription.PrescriptionId" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this prescription? This action cannot be undone!');">Delete</a>
                    </div>
                </div>
            </div>
        }
    }
</form>
