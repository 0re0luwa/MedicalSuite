@page
@using System.Security.Claims
@model MedicalSuiteWeb.Pages.Prescriptions.ViewPrescriptionsModel
@{
    ViewData["Title"] = "View Prescriptions";
}
@{
    if (HttpContext.User.FindFirstValue(ClaimTypes.Role) != null)
    {
        Layout = LayoutAuthorizer.GetLayoutFromRole(this.HttpContext);
    }
    else
    {
        Layout = "_Layout";
    }
}

<form method="post" class="container mt-4">
    <div class="row mb-3">
        <div class="col-1">
            <a class="btn btn-primary" asp-area="" asp-page="/Prescriptions/AddPrescription">Add</a>
        </div>
    </div>
    <div class="row mb-3">
        <div class="col-md-3">
            <label class="form-label">Person</label>
        </div>
        <div class="col-md-7">
            <select class="form-control" asp-for="SelectedPersonId" asp-items="Model.People"></select>
        </div>
        <div class="col-md-2">
            <button class="btn btn-primary">Display</button>
        </div>
    </div>

    @if (Model.Prescriptions.Count == 0)
    {
        <p>No prescriptions found for the selected person.</p>
    }
    else
    {
        @foreach (var prescription in Model.Prescriptions)
        {
            <div class="row mb-3 border">
                <div class="col-md-3">
                    <label class="form-label">Name:</label>
                </div>
                <div class="col-md-9">
                    <label class="form-label">@prescription.PrescriptionName</label>
                </div>
            </div>

            <div class="row mb-3 border">
                <div class="col-md-3">
                    <label class="form-label">Strength:</label>
                </div>
                <div class="col-md-9">
                    <label class="form-label">@prescription.PrescriptionStrength</label>
                </div>
            </div>

            <div class="row mb-3 border">
                <div class="col-md-3">
                    <label class="form-label">Quantity:</label>
                </div>
                <div class="col-md-9">
                    <label class="form-label">@prescription.PrescriptionQuantity</label>
                </div>
            </div>

            <div class="row mb-3 border">
                <div class="col-md-3">
                    <label class="form-label">Directions:</label>
                </div>
                <div class="col-md-9">
                    <label class="form-label">@prescription.PrescriptionDirections</label>
                </div>
            </div>

            <div class="row mb-3 border">
                <div class="col-md-3">
                    <label class="form-label">Written Date:</label>
                </div>
                <div class="col-md-9">
                    <label class="form-label">@prescription.WrittenDate.ToString("yyyy-MM-dd")</label>
                </div>
            </div>

            <div class="row mb-3 border">
                <div class="col-md-3">
                    <label class="form-label">Expiration Date:</label>
                </div>
                <div class="col-md-9">
                    <label class="form-label">@prescription.ExpirationDate.ToString("yyyy-MM-dd")</label>
                </div>
            </div>

            <div class="row mb-3 border">
                <div class="col-md-3">
                    <label class="form-label">Notes:</label>
                </div>
                <div class="col-md-9">
                    <label class="form-label">@prescription.Notes</label>
                </div>
            </div>

            <div class="row mb-3 border">
                <div class="col-md-3">
                    <a class="btn btn-primary" asp-page="EditPrescription" asp-route-id="@prescription.PrescriptionId">Edit</a>
                </div>
                <div class="col-md-3">
                    <a class="btn btn-danger" asp-page="DeletePrescription" asp-route-id="@prescription.PrescriptionId" onclick="return confirm('Are you sure you want to delete this prescription? This action cannot be undone!');">Delete</a>
                </div>
            </div>
        }
    }
</form>
